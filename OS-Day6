------------------------------------------------------------------------------------------------------------------------
COSC DAY 6 GENERAL LINKS (IF ANY)
WINDOWS PROCESS VALIDITY INFO LOCATED AT: https://os.cybbh.io/public/os/latest/008_windows_process_validity/winproc_fg.html
WINDOWS UAC INFO LOCATED AT: https://os.cybbh.io/public/os/latest/009_windows_uac/uac_fg.html
TEXT CAPITALIZER FOR NOTES: https://pteo.paranoiaworks.mobi/textcapitalizer/
IANA PORT LIST: https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml
  WILL DETAIL REPORTED UNAUTHORIZED USE ALONG WITH OTHER PERTINENT INFORMATION IN SEARCHABLE DATABASE
IBM EPHEMERAL PORTS INFO: https://www.ibm.com/docs/en/rsct/3.2?topic=considerations-ephemeral-ports
  DOCUMENTATION ABOUT EPHEMERAL PORTS 

------------------------------------------------------------------------------------------------------------------------
GENERAL NOTES:
PROCESS VALIDITY GENERAL TAKEAWAYS:
  BE AWARE OF WHERE A FILE IS RUNNING FROM! SUSPICIOUS LOCATIONS INCLUDE BUT ARE NOT LIMITED TO: EXES FROM ROOT OF FILE SYSTEM OR DOWNLOADS FOLDER, DLLS OUTSIDE OF C:\WINDOWS\SYSTEM32
  CHECK DESCRIPTIONS, MALICIOUS INDICATORS INCLUDE POOR GRAMMAR OR NO DESCRIPTION WHATSOEVER
  CHECK FOR USERS RUNNING SYSTEM AUTHORITY PROCESSES!!!
  CHECK NETWORK CONNECTIONS FOR ABNORMAL PORTS AND CONNECTIONS: RHP<->RHP, 4444 (METASPLOIT), ANY NOTICABLE ABNORMAL PATTERNS, LEET SPEAK 
  SYSTEM PROCESSES WITH HIGH PIDS SHOULD BE LOOKED AT CRITICALLY AS THEY SHOULD NORMALLY BE EXECUTING SOONER
DEMO NOTES:
PROCESS VALIDITY DEMO NOTES:
  (STARTING FROM C:/)
  PROCESSES AND SERVICES:
    get-process | Sort -Property Id | more LISTS ALL PROCESSES AND SORTS BY PID
    Get-Process chrome | foreach {$a} {$_.modules} | more LISTS MODULES/DLLS USED BY DEFINED PROCESS AND THEIR FILE LOCATIONS
    Get-Process | Select Name, Id, Description | Sort -Property Id | more LISTS ALL PROCESSES WITH PROPERTIES SPECIFIED IN THE CMDLET 
    Get-Process SMSS,CSRSS,LSASS | Sort -Property Id LISTS THE THREE SPECIFIED PROCESSES AND SORTS THOSE BY PID
    Get-CimInstance Win32_Process VIEW PROCESS INSTANCES WITH PPID
    Get-CimInstance Win32_Process | Get-Member VIEW PROCESS INSTANCES WITH MORE DETAILS
    Get-CimInstance Win32_Process | select name,ProcessId,ParentProcessId | sort processid VIEW THE PROCESSES WITH PID AND PPID SORTED BY PID
    tasklist /v | more CMD EQUIVALENT OF PRIOR COMMANDS FOR PROCESS VALIDITY, USE IF POWERSHELL IS UNAVAILABLE!
    tasklist /svc CMD - DISPLAY SERVICE INFORMATION FOR EACH PROCESS WITHOUT TRUNCATION
    tasklist /m | more CMD - DISPLAY MODULES/DLLS ASSOCIATED TO ALL PROCESSES
    tasklist /m /fi "IMAGENAME eq chrome.exe" CMD - DISPLAY MODULES/DLLS ASSOCIATED TO A SPECIFIC PROCESS
    tasklist /fo:{table|list|csv}` CMD - PRIOR COMMANDS WITH CRISPER FORMATTING
    sc queryex type=service | more CMD - LIST SERVICES
    sc queryex type=service state=inactive CMD - LIST INACTIVE SERVICES
  SCHEDULED TASKS:
    Get-ScheduledTask | Select * | select -First 1 VIEW ALL PROPERTIES OF THE FIRST SCHEDULED TASK
    schtasks /query /tn "TASKNAME" /v /fo list CMD - VIEW ALL PROPERTIES OF SPECIFIED SCHEDULED TASK
  TCP CONNECTIONS:
    Get-NetTCPConnection -State Established SHOW ALL CONNECTIONS IN THE "ESTABLISHED" STATE.
    netstat -anob | more DISPLAYS ALL TCP/UDP CONNECTIONS WITH PORTS IN NUMERICAL FORM WITH PID AND EXECUTABLE ASSOCIATED TO THE CONNECTIONS

------------------------------------------------------------------------------------------------------------------------
CTFD CHALLENGES - 09_windows_process_validity
------------------------------------------------------------------------------------------------------------------------
CTFD CHALLENGES - 10_windows_uac
------------------------------------------------------------------------------------------------------------------------
CTFD CHALLENGES - 11_windows_services
Windows_Services_Basics_1 5
What command-line (cmd) command will show service information?
  ANSWER: sc querry
Windows_Services_Basics_2 5
What command-line (cmd) command will show all services, running or not running? The flag is the full command, for all services.
Windows_Services_Basics_3 5
What PowerShell command will list all services?
  ANSWER: get-service
Windows_Services_Basics_4 5
What registry location holds all service data?
  ANSWER: HKLM\SYSTEM\CurrentControlSet\Services
Windows_Services_Basics_5 5
What registry subkey holds a service's .dll location? The flag is the subkey name (full path not needed).
  ANSWER:
Windows_Services_Basics_6 10
Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?
  ANSWER: Legit VIA get-service
Windows_Services_Basics_7 10
Figure out the SID of the only Totally-Legit service. Example: S-1-5-80-159957745-2084983471-2137709666-960844832-[1182961511] Submit only the [bracketed] portion of the SID. HINT: Run the command on the service name, not the display name.
  ANSWER:

------------------------------------------------------------------------------------------------------------------------
